<link rel="import" href="../bower_components/polymer/polymer-element.html">
<dom-module id="screen-mode-switch">
    <template>
        <style>
            :host {
                display: inline-block;
                min-width: 48px;
                min-height: 48px;
                outline: none;
            }
            [hidden] {
                display: none;
            }

            svg {
                opacity: 0.8;
            }
            :focus svg,
            :active svg {
                opacity: 1;
                transform: scale(1.1);
            }
        </style>
        <div id="enter" hidden$="{{fullscreen}}">
            <svg fill="#FFFFFF" height="48" viewBox="0 0 24 24" width="48" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none"/>
                <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
            </svg>
        </div>
        <div id="exit" hidden$="{{!fullscreen}}">
            <svg fill="#FFFFFF" height="48" viewBox="0 0 24 24" width="48" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none"/>
                <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>
            </svg>
        </div>
    </template>
    <script>
        class ScreenModeSwitch extends Polymer.Element {
            static get is() { return 'screen-mode-switch'; }
            static get properties() {
                return {
                    fullscreen: {
                        type: Boolean,
                        readOnly: true,
                        value: false,
                        notify: true
                    },
                    target: {
                        type: HTMLElement
                    }
                }
            }

            constructor(){
                super();
                this._toggleFullScreen = this._toggleFullScreen.bind(this);
                this._fullScreenChange = this._fullScreenChange.bind(this);
                this._fullScreenError = this._fullScreenError.bind(this);
            }

            ready() {
                super.ready();
                this.setAttribute("role", "button");
                this.setAttribute("tabindex", "0");
                this.addEventListener('click', this._toggleFullScreen);
                document.addEventListener('fullscreenchange', this._fullScreenChange);
                document.addEventListener('fullscreen', this._fullScreenChange);
                document.addEventListener('fullscreenerror', this._fullScreenError);
                document.onfullscreenchange = function ( event ) {
                console.log("FULL SCREEN CHANGE")
                };
            }

            _toggleFullScreen(){
                if(this.fullscreen === false) {
                    this.target && this.target.webkitRequestFullscreen();
                } else {
                    document.webkitExitFullscreen();
                }
            }

            _fullScreenChange(event) {
                this.fullscreen = document.fullscreen;
            }

            _fullScreenError(error) {
                console.log(error);
            }
        }
        customElements.define(ScreenModeSwitch.is, ScreenModeSwitch);
    </script>
</dom-module>
